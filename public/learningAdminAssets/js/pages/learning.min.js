$(document).ready(function() {

  	//For message remove 

    setTimeout(function() {
        $(".alert-success").alert('close');
    }, 5000);


    //Add input field and remove dynamically.. for Lesson 

    var maxField = 5; //Input fields increment limitation
    var addLesson = $('#addLesson'); //Add button selector
    var orderLesson = $('#orderLesson'); //Input field wrapper
    var fieldHTML = '<div><div class="form-group" id="removeInputField"><label>Lesson Title</label><div class="input-group"><input type="text" name="title[]" class="form-control" required><div class="input-group-prepend"><button id="removeLesson" class="btn btn-outline-danger" type="button"><i class="mdi mdi-minus"></i></button></div></div></div><div class="form-group"><label>Lesson Order</label><input type="number" name="order_number[]" min="1" max="100" class="form-control" required></div></div>'; //New input field html                                     
                                  
    var x = 1; //Initial field counter is 1
    
    //Once add button is clicked
    $(addLesson).click(function(){
        //Check maximum number of input fields
        if(x < maxField){ 
            x++; //Increment field counter
            $(orderLesson).append(fieldHTML); //Add field html
        }
        else{
        	swal({
        		'title': 'Maximum '+maxField+' fields.',
        		'text':''
        	});
        }
    });


    
    //Once remove button is clicked
    $(orderLesson).on('click', '#removeInputField', function(e){
        e.preventDefault();
        $('#removeInputField').parent('div').remove();
        x--; //Decrement field counter
    });


    //Input field for Quizzes

    $('#Single').change(
    function(){ 
        if ($(this).is(':checked') && $(this).val() == 'radio') {
                $("#optionCheckbox").empty(); 
                    var url = window.location.href.split('/');
                    var lastWord = url.pop() || url.pop();
 
                    if (lastWord == 'edit') {
                        var inputField = $('input[name="countOptions"]').val();
                        y = inputField;

                    }else{
                        var inputField = 2; 
                        y = inputField;
                    }
                    var Html = '<div id="optionRadio">';
                    for(var i = 1; i <= inputField; i++){
                        if (lastWord == 'edit') {
                            Html += '<div id="optionRadio">';
                        }
                        Html += '<div class="form-group" id="'+i+'">';
                                        
                        Html += '<label>Option #'+i+'</label>';
                        Html += '<div class="input-group mb-3">';
                        
                        if (lastWord == 'edit') {
                            var optionValue = $('#optionsValue'+i).val();
                        }else{
                            var optionValue = '';
                        }
                         
                        Html += '<input type="text" id="option'+i+'" required="required" name="options[]" class="form-control" value="'+optionValue+'">';

                        
                        Html += '<div class="input-group-prepend">';
                        Html += '<div class="input-group-text">';
                        Html += '<input type="radio" id="check'+i+'" name="correct_answer[]" value="'+optionValue+'">';
                        Html += '</div>';
                        Html += '</div>';
                        if (lastWord == 'edit' && i > 2) {
                            Html += '<div class="input-group-prepend">';
                            Html += '<button id="removeOptionField" class="btn btn-outline-danger" type="button"><i class="mdi mdi-minus"></i></button>'
                            Html += '</div>';
                        }
                        Html += '</div>';

                        Html += '</div>';

                        if (lastWord == 'edit') {
                            Html += '<div id="optionRadio">';
                        }
                    }
                    Html += '</div>';
           $('#optionCheckbox').replaceWith(Html);
        }
    });


    $('#Multiple').change(
    function(){

        if ($(this).is(':checked') && $(this).val() == 'checkbox') {
                $('#optionRadio').empty(); 
                var url = window.location.href.split('/');
                var lastWord = url.pop() || url.pop();   

                if (lastWord == 'edit') {
                    var inputField = $('input[name="countOptions"]').val();

                    y = inputField;
                }else{
                    var inputField = 2;
                    y = inputField; 
                } 
                var Html = '<div id="optionCheckbox">';
                    for(var i = 1; i <= inputField; i++){
                        if (lastWord == 'edit') {
                            Html += '<div id="optionCheckbox">';
                        }
                        
                        Html += '<div class="form-group" id="'+i+'">';
                                        
                        Html += '<label>Option #'+i+'</label>';
                        Html += '<div class="input-group mb-3">';
                        if (lastWord == 'edit') {
                            var optionValue = $('#optionsValue'+i).val();
                        }else{
                            var optionValue = '';
                        }          
                        Html += '<input type="text" id="option'+i+'" required="required" name="options[]" class="form-control" value="'+optionValue+'">';
                        
                        Html += '<div class="input-group-prepend">';
                        Html += '<div class="input-group-text">';
                        Html += '<input type="checkbox" id="check'+i+'" name="correct_answer[]" value="'+optionValue+'">';
                        Html += '</div>';
                        Html += '</div>';
                        if (lastWord == 'edit' && i > 2) {
                            Html += '<div class="input-group-prepend">';
                            Html += '<button id="removeOptionField" class="btn btn-outline-danger" type="button"><i class="mdi mdi-minus"></i></button>'
                            Html += '</div>';
                        }
                        Html += '</div>';

                        Html += '</div>';
                       if (lastWord == 'edit') {
                            Html += '</div>';
                        }
                    }
                    Html += '</div>';
           $('#optionRadio').replaceWith(Html);
        }
    });

    var moreField = 5; //Input fields increment limitation
    var moreOption = $('#moreOption'); //Add button selector
    var optionIncrease = $('.optionIncrease'); //Input field wrapper
    var url = window.location.href.split('/');
    var lastWord = url.pop() || url.pop();  // handle potential trailing slash

    if (lastWord == 'edit') {
        var y=$('input[name="countOptions"]').val();
    }else{
        var y=2;
    }

    //Once add button is clicked
    $(moreOption).click(function(){
        //Check maximum number of input fields

        if(y < moreField){ 
            y++; //Increment field counter

            if($("#Single").is(":checked")){
                var optionField = '<div id="optionRadio"><div class="form-group" id="'+y+'"><label>Option #'+y+'</label><div class="input-group mb-3"><input type="text" id="option'+y+'" name="options[]" class="form-control" required><div class="input-group-prepend"><div class="input-group-text"><input type="radio" id="check'+y+'" name="correct_answer[]" value=""></div></div><div class="input-group-prepend"><button id="removeOptionField" class="btn btn-outline-danger" type="button"><i class="mdi mdi-minus"></i></button></div></div></div></div>';                          
                $('#optionRadio').append(optionField);
            }
            if ($("#Multiple").is(":checked")) {
                var optionField = '<div id="optionCheckbox"><div class="form-group" id="'+y+'"><label>Option #'+y+'</label><div class="input-group mb-3"><input type="text" id="option'+y+'" name="options[]" class="form-control" required><div class="input-group-prepend"><div class="input-group-text"><input type="checkbox" id="check'+y+'" name="correct_answer[]" value=""></div></div><div class="input-group-prepend"><button id="removeOptionField" class="btn btn-outline-danger" type="button"><i class="mdi mdi-minus"></i></button></div></div></div></div>';                          
                $('#optionCheckbox').append(optionField);  
            }
        }
        else{
            swal({
                'title': 'Maximum '+y+' fields.',
                'text':''
            });
        }
    });


    //Once remove button is clicked
    $(optionIncrease).on('click', '#removeOptionField', function(e){
        e.preventDefault();
        $('#'+y).parent('div').remove();
        y--; //Decrement field counter
    });

   

    $("body").on('keyup', 'input[id="option1"]', function() { 
        var option1 = this.value;
        $('#check1').val(option1);
    });

    $("body").on('keyup', 'input[id="option2"]', function() { 
        var option2 = this.value;
        $('#check2').val(option2);
    });
    
    $("body").on('keyup', 'input[id="option3"]', function() { 
        var option3 = this.value;
        $('#check3').val(option3);
    });
    
    $("body").on('keyup', 'input[id="option4"]', function() { 
        var option4 = this.value;
        $('#check4').val(option4);
    });
    
    $("body").on('keyup', 'input[id="option5"]', function() { 
        var option5 = this.value;
        $('#check5').val(option5);
    });

    

});


function confirmDelete(Id) {
  	event.preventDefault(); 

	swal({
	  title: "Are you sure to delete?",
	  text: "",
	  type: "warning",
	  showCancelButton: true,
	  confirmButtonColor: "#DD6B55",
	  confirmButtonText: "Yes, delete it!",
	  closeOnConfirm: false
	 },
	 function(isConfirm){
	 	if (isConfirm) {
			document.getElementById('delete'+Id).submit();

			swal({
				title: "Processing..",
				showConfirmButton: false,
				showCancelButton: false,
			});
	 	}
	});
}


    